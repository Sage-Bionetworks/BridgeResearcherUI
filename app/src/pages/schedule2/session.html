<div class="session ui segments" data-bind="attr: {id: generateId('')}">
  <div class="session2 ui blue inverted segment">
    <span style="flex: 1" data-bind="text: nameObs"></span>
    <span>
      <span data-bind="text: totalMinutesObs()" style="margin-right: 1rem"></span>
      <i class="large arrow alternate circle up outline icon"
        data-bind="click: moveSessionUp, style: {opacity: firstOpacityObs($index())}"></i>
      <i class="large arrow alternate circle down outline icon"
        data-bind="click: moveSessionDown, style: {opacity: lastOpacityObs($index())}"></i>
      <i class="red large times circle outline icon" 
        data-bind="click: removeSession"></i>
    </span>
  </div>
  <div class="ui segment">
    <div class="fields">
      <div class="required twelve wide field" data-bind="attr: { id: generateId('name') }">
        <label>Name</label>
        <input type="text" data-bind="textInput: nameObs">
      </div>
      <div class="required six wide field" data-bind="attr: { id: generateId('startEventId') }">
        <label>Start event ID</label>
        <select class="ui dropdown" style="width: 70%" data-bind="options: eventIdsObs,
          optionsCaption: 'Select an event ID...', optionsText: 'text', 
          optionsValue: 'value', value: startEventIdObs"></select>
      </div>
    </div>
    <div class="field">
      <label>Label</label>
      <!-- ko foreach: labelsObs -->
        <localized-label message params="labelsObs: $parent.labelsObs, label: $data, prefix: $parent.prefix + '_'">
        </localized-label>
      <!-- /ko -->
      <button class="ui mini button" data-bind="click: addLabel, 
        visible: labelsObs().length === 0">
        Add Label
      </button>
    </div>
    <div class="fields">
      <div class="field">
        <label>Delay</label>
        <ui-duration params="fieldObs: delayObs, fields: 'minutes hours days weeks'"></ui-duration>
      </div>
      <div class="field">
        <label>Then repeat every</label>
        <ui-duration params="fieldObs: intervalObs, fields: 'days weeks'"></ui-duration>
      </div>
      <div class="field">
        <label>This many times</label>
        <input type="text" placeholder="Until end of study" style="width:10rem"
          data-bind="textInput: occurrencesObs">
      </div>
    </div>
    <h4>Time Windows</h4>
    <div class="field" data-bind="attr: {id: generateId('timeWindows')}">
      <button class="ui mini button" data-bind="click: addWindow,
        visible: timeWindowsObs().length === 0">
        Add Time Window
      </button>
      <div data-bind="foreach: timeWindowsObs">
        <time-window style="display: block; margin-bottom: 1rem" 
          params="timeWindowsObs: $parent.timeWindowsObs, timeWindow: $data, prefix: $parent.prefix">
        </time-window>
      </div>
    </div>
  </div>


  <div class="ui blue segment" data-bind="attr: {id: generateId('assessments')}">
    <h4>Assessments</h4>
    <div class="field">
      <div data-bind="foreach: assessmentsObs">
        <assessment-ref params="assessmentsObs: $parent.assessmentsObs, assessment: $data, prefix: $parent.prefix">
        </assessment-ref>
      </div>
    </div>
    <div class="fields" style="align-items: baseline">
      <div class="inline field" style="flex:1">
        <button class="ui mini button" data-bind="click: openAssessmentDialog">
          Add Assessment(s)&hellip;
        </button>
      </div>
      <div class="inline field" data-bind="attr: {id: generateId('performanceOrder')}">
        <label>Performance Order</label>
        <select class="ui dropdown" data-bind="options: performanceOrderTypesObs,
          optionsCaption: 'Select...', optionsText: 'text', 
          optionsValue: 'value', value: performanceOrderObs"></select>
      </div>
    </div>
  </div>

  <div class="ui blue segment">
    <h4>Notifications</h4>
    <div class="fields">
      <div class="six wide field">
        <label>Notify Participant</label>
        <select class="ui dropdown" data-bind="options: notifyAtTypesObs,
          optionsCaption: 'None', optionsText: 'text', 
          optionsValue: 'value', value: notifyAtObs"></select>
      </div>
      <div class="four wide field" data-bind="attr: {id: generateId('reminderPeriod')}">
        <label>Reminder</label>
        <ui-duration params="fieldObs: reminderPeriodObs, fields: 'minutes hours days'"></ui-duration>
      </div>
      <div class="six wide field" data-bind="attr: {id: generateId('remindAt')}">
        <label>&#160;</label>
        <select class="ui dropdown" data-bind="options: remindAtTypesObs, 
          optionsCaption: 'None', optionsText: 'text', 
          optionsValue: 'value', value: remindAtObs"></select>
      </div>
    </div>
    <div class="fields" style="margin-top: -1rem">
      <div class="six wide field">
        &#160;
      </div>
      <div class="ten wide field" data-bind="attr: {id: generateId('allowSnooze')}">
        <ui-checkbox style="line-height: 3" params="checkedObs: allowSnoozeObs">
          Allow snooze
        </ui-checkbox>
      </div>
    </div>

    <div data-bind="attr: {id: generateId('messages')}">
      <h4>Messages</h4>
      <!-- ko foreach: messagesObs -->
        <message params="messagesObs: $parent.messagesObs, message: $data, prefix: $parent.prefix"></message>
      <!-- /ko -->
      <button class="ui mini button" style="margin-top: 1rem" data-bind="click: addMessage">
        Add Message
      </button>
    </div>
  </div>
</div>
