<div class="fixed-header">
    <div class="fixed-header-title">
        <div class="fixed-header-heading">
            <h3>Consent Groups</h3>
        </div>
        <div class="fixed-header-buttons" data-bind="visible: isDeveloper">
            <button class="ui tiny button" data-bind="visible: isDeveloper, disable: !atLeastOneChecked(), click: copyToClipboard">Copy to Clipboard</button>
            <button class="ui red tiny button" data-bind="disable: !atLeastOneChecked(), click: deleteItems">Delete</button>
            <a href="#/subpopulations/new" class="ui primary tiny button">New Consent Group</a>
        </div>
    </div>
    <div class="ui empty secondary pointing menu"></div>
</div>
<div class="scrollbox">
    <errors></errors>

    <div class="ui grid">
        <div class="ten wide column">
            <table class="ui compact selectable table">
                    <thead>
                        <tr>
                            <th width="10" data-bind="visible: isDeveloper"></th>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Matching Criteria</th>
                            <th width="100"></th>
                        </tr>
                    </thead>
                    <tbody class="no_records" data-bind="if: itemsObs().length === 0">
                        <tr>
                            <td data-bind="attr:{colspan: $parent.isDeveloper ? 5 : 4}, html: recordsMessageObs"></td>
                        </tr>
                    </tbody>  
                    <tbody data-bind="foreach: itemsObs">
                        <tr data-bind="css: { positive: $data.active }">
                            <td data-bind="visible: $parent.isDeveloper">
                                <ui-checkbox params="checkedObs: $data.checkedObs"></ui-checkbox>
                            </td>
                            <td>
                                <a data-bind="attr: {'href': '#/subpopulations/'+encodeURIComponent($data.guid)}, text: $data.name"></a>
                            </td>
                            <td data-bind="text: $data.description"></td>
                            <td data-bind="html: $parent.criteriaLabel($data.criteria)"></td>
                            <td>
                                <span data-bind="visible: $data.required" class="green ui text">
                                    <i class="checkmark icon"></i> Required
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
        </div>
        <div class="six wide column">
            <div class="ui message">
                <p>A consent group defines a set of users who must agree to a specific consent to participate in a study. Consents can be optional; these will not prevent participants from using Bridge.</p>

                <ul style="padding-left:1rem">
                <li>Users are assigned to one or more consent groups on every request (always at least one);</li>
                <li>Bridge verifies that the user has signed all their required consents;</li>
                <li>If they have, the request proceeds normally. If not, Bridge returns a 412 status code and the body of the response will include the user's session and consent status. The user is signed in, but unconsented.</li>
                </ul>
                
                <p><b>Note:</b> filtering on Bridge is opt-in: if a user does not match <i>any</i> consent goup, then they are assumed to match <i>all</i> consent groups. To disable consent for a group of users, create an optional consent group that matches those users, so they do not have to sign it. Then Bridge will not block their requests.</p>
            </div>
        </div>
    </div>    
</div>
