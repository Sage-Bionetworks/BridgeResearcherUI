<div class="fixed-header">
    <div class="fixed-header-title">
        <div class="fixed-header-heading">
            <div class="ui breadcrumb">
                <a class="section" href="#/participants"
                    data-bind="visible: isPublicObs">Participants</a>
                <a class="section" href="#/enrollees"
                    data-bind="visible: !isPublicObs()">External Identifiers</a>
                <i class="right chevron icon divider"></i>
            </div>            
            <h3 data-bind="html: titleObs"></h3>
        </div>
        <div class="fixed-header-buttons"></div>
    </div>
    <!-- ko component: {name: 'participant-tabset', params: { userIdObs: userIdObs,
        isNewObs: isNewObs, isPublicObs: isPublicObs, statusObs: statusObs}} --><!-- /ko -->
</div>
<div class="scrollbox">
    <div class="line-control" style="margin-bottom: 1rem">
        <div class="line-control-stretch">
            <div class="ui breadcrumb">
                <a class="section" 
                    data-bind="href:'#/participants/'+userIdObs()+'/newActivities'">Activities</a>
                <i class="right chevron icon divider"></i>
                <b data-bind="html: activityLabelObs"></b>
            </div>
        </div>
    </div>
    <errors></errors>
    <div class="line-control">
        <div class="line-control-stretch">
            <div class="ui action input" data-bind="flatpickr: startDateObs, 
                timeout: 50, wrap: true, onChange: doCalSearch">
                <input type="text" placeholder="Created on or after" readonly data-input>
                <div data-toggle></div>
                <button class="ui icon button" data-clear data-bind="click: clearStart"><i class="remove circle icon"></i></button>
            </div>
            <div class="ui action input" data-bind="flatpickr: endDateObs, 
                timeout: 50, wrap: true, onChange: doCalSearch">
                <input type="text" placeholder="Created before" readonly data-input>
                <div data-toggle></div>
                <button class="ui icon button" data-clear data-bind="click: clearEnd"><i class="remove circle icon"></i></button>
            </div>
            <div class="label-field-padding" data-bind="visible: warnObs">
                <i class="ui yellow warning sign icon"></i> Set both dates to filter.
            </div>
        </div>
        <div>
            <forward-pager params="vm: vm"></forward-pager>
        </div>
    </div>
    <table class="ui compact selectable table">
        <thead>
            <tr>
                <th>Activity</th>
                <th>Status</th>
                <th>Schedule Window</th>
                <th>Execution Time</th>
                <th>Client Data</th>
            </tr>
        </thead>
        <tbody class="no_records" data-bind="if: itemsObs().length === 0">
            <tr>
                <td colspan="5" data-bind="html: recordsMessageObs"></td>
            </tr>
        </tbody>            
        <tbody data-bind="foreach: itemsObs">
            <tr>
                <td data-bind="attr: {title: $parent.formatTitleCase($data.activity.activityType)},
                     css: {disabled: $data.isDisabled}">
                    <i data-bind="css: $parent.formatActivityClass($data)"></i>
                    <a target="_blank" rel="noopener" data-bind="text: $parent.formatActivity($data), 
                        href: '#/scheduleplans/'+$data.schedulePlanGuid"></a>
                </td>
                <td data-bind="text: $parent.formatTitleCase($data.status), 
                    css: {disabled: $data.isDisabled}">
                </td>
                <td data-bind="css: {disabled: $data.isDisabled}">
                    <span data-bind="text: $parent.formatDateTime($data.scheduledOn)">
                    </span>&mdash;<span data-bind="text: $parent.formatDateTime($data.expiresOn)">
                    </span>
                </td>
                <td data-bind="css: {disabled: $data.isDisabled}">
                    <span data-bind="text: $parent.formatDateTime($data.startedOn)">
                    </span>&mdash;<span data-bind="text: $parent.formatDateTime($data.finishedOn)">
                    </span>
                </td>
                <td>
                    <div data-bind="visible: $data.clientData">
                        <div class="json-expand-control" data-bind="visible: $data.collapsedObs">
                            <a href="" class="json-expand-control" data-bind="visible: $data.collapsedObs, click: $component.toggle">
                                {<i style="margin:0;padding:0" class="plus square outline icon"></i>}
                            </a>
                        </div>
                        <div style="position:relative" class="json-expand-control" data-bind="visible: !$data.collapsedObs()">
                            <a href="" style="position:absolute; left:.75rem; top:.15rem" 
                                class="json-expand-control" data-bind="visible: !$data.collapsedObs(), click: $component.toggle">
                                <i class="minus square outline icon"></i>
                            </a>
                            <pre data-bind="visible: !$data.collapsedObs(), html: $data.formattedData"></pre>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
