<div class="fixed-header">
    <div class="fixed-header-title">
        <div class="fixed-header-heading">
            <div class="ui breadcrumb">
                <a href="#/app_configs" class="section">App Configs</a>
                <i class="right chevron icon divider"></i>
            </div>
            <h3 data-bind="text: titleObs"></h3>
        </div>
        <div class="fixed-header-buttons">
            <button class="ui tiny primary button" data-bind="click: save">Save</button>
        </div>
    </div>
    <div class="ui empty secondary pointing menu"></div>
</div>
<div class="scrollbox">
    <errors></errors>
    <form class="ui form">
        <div class="two fields">
            <div class="seven wide field" id="label">
                <label>Label</label>
                <input type="text" data-bind="textInput: labelObs, hasFocus: true"/>
            </div>
            <div class="four wide field"></div>
            <div class="four wide field">
                <!-- ko component: {name:"app_version_criteria", params:{
                    id:"", criteriaObs:criteriaObs}} --><!-- /ko -->
            </div>
        </div>
        <div class="ui relaxed grid" style="margin-top:1rem">
            <div class="two column row">
                <div class="column">
                    <h3>Schemas (Tasks)</h3>
                    <table class="ui compact table" data-bind="visible: schemaReferencesObs().length > 0">
                        <tbody data-bind="foreach: schemaReferencesObs, 
                            dragula: {listObs: schemaReferencesObs, indexObs: schemaIndexObs, dragHandleSelector: 'dragHandle'}">
                            <tr>
                                <td class="dragHandle" data-bind="text: $data.name"></td>
                                <td>
                                    <div data-bind="attr: {id: 'schemaReferences'+$index()+'_revision'}">
                                        <ui-select params="fieldObs: $data.revisionObs, 
                                            optionsSrc: $data.revisionList, 
                                            optionsCaption: 'Select Revision:'"></ui-select>
                                    </div>
                                </td>
                                <td><button class="ui basic red compact mini button" 
                                        data-bind="click: $component.removeSchema.bind($component)">Delete</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="ui tiny button" data-bind="click: openSchemaSelector">Edit Schemas</button>

                    <h3>Surveys</h3>
                    <table class="ui compact table" data-bind="visible: surveyReferencesObs().length > 0">
                        <tbody data-bind="foreach: surveyReferencesObs, 
                            dragula: {listObs: surveyReferencesObs, indexObs: surveyIndexObs, dragHandleSelector: 'dragHandle'}">
                            <tr>
                                <td class="dragHandle" data-bind="text: $data.name"></td>
                                <td>
                                    <div data-bind="attr: {id: 'surveyReferences'+$index()+'_createdOn'}">
                                        <ui-select params="fieldObs: $data.createdOnObs, 
                                            optionsSrc: $data.createdOnList, 
                                            optionsCaption: 'Select Revision:'"></ui-select>
                                    </div>
                                </td>
                                <td><button class="ui basic red compact mini button" 
                                        data-bind="click: $component.removeSurvey.bind($component)">Delete</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="ui tiny button" data-bind="click: openSurveySelector">Edit Surveys</button>
                </div>
                <div class="column field">
                    <h3>Client Data</h3>
                    <label>Client data should be in JSON format</label>
                    <div id="clientData">
                        <textarea style="font-family: monospace; height: 50rem" 
                            data-bind="textInput: clientDataObs"></textarea>
                    </div>
                    <div style="padding-top:1rem">
                            <button class="ui tiny primary button" data-bind="click: reformat">Reformat</button>
                    </div>
                </div>
            </div>
            <div class="two column row" style="padding-top:2rem">
                <div class="column">
                    <div class="field" id="createdOn">
                        <label>Created On</label>
                        <div class="inline-form-text" data-bind="text: formatDateTime(createdOnObs())"></div>
                    </div>
                </div>
                <div class="column">
                    <div class="field" id="modifiedOn">
                        <label>Modified On</label>
                        <div class="inline-form-text" data-bind="text: formatDateTime(modifiedOnObs())"></div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
