<div class="fixed-header">
    <div class="fixed-header-title">
        <div class="fixed-header-heading">
            <div class="ui breadcrumb">
                <a href="#/schemas" class="section">Upload Schemas</a>
                <i class="right chevron icon divider"></i>
            </div>             
            <h3>
                <span data-bind="visible: nameObs().length > 0, text: nameObs"></span>
                <span data-bind="visible: nameObs().length === 0">New Upload Schema</span>
            </h3>
        </div>
        <div class="fixed-header-buttons">
            <button class="ui small primary button" data-bind="click: save">Save</button>
        </div>
    </div>
    <div class="ui secondary pointing menu">
        <span class="active item">
            <i class="file outline icon"></i> Editor
        </span>
        <a data-bind="attr: {href: '#/schemas/'+encodeURIComponent(schemaIdObs())+'/versions'}, visible: !!revisionObs()" class="item">
            <i class="history icon"></i> History
        </a>
        <div class="right menu">
            <div class="item" data-bind="visible: !!schemaIdObs()">
                <i class="clock icon"></i> <span data-bind="text: revisionLabel"></span>
            </div>
        </div>
    </div>
</div>
<div class="scrollbox">
    <form class="ui form">
        <errors></errors>
        <div class="three fields">
            <div class="required field" id="name">
                <label>Name</label>
                <input type="text" data-bind="textInput: nameObs, hasFocus: true"/>
            </div>
            <div class="required field" id="schemaType">
                <label>Schema Type</label>
                <ui-select params="fieldObs: schemaTypeObs, fieldLabel: schemaTypeLabel, optionsSrc: schemaTypeOptions"></ui-select>
            </div>
            <div class="required field" id="schemaId" data-bind="visible: !!!revisionObs()">
                <label>Identifier</label>
                <input type="text" data-bind="textInput: schemaIdObs"/>
            </div>
            <div class="field" data-bind="visible: !!revisionObs()">
                <label>Identifier</label>
                <input readonly data-bind="value: schemaIdObs"/>
            </div>
        </div>
    </form>

    <h3>Field Definitions</h3>

    <p class="help-text">Drag items to reorder them. </p>

    <div data-bind="visible: itemsObs().length === 0">
        <p>There are currently no field definitions in this upload schema.</p>
        <p>
            <button class="ui primary button" data-bind="click: addFirst">
                <i class="add square icon"></i> Add Field
            </button>
        <p>
    </div>
    <div class="ui form schema sfieldZone" data-bind="dragula: {
        elementSelector: '.field_definitions',
        dragHandleSelector: '.draggable',
        listObs: itemsObs
    }, foreach: itemsObs">
        <div class="field_definitions" data-bind="component: {
            name: 'field_definition',
            params: { field: $data, itemsObs: $parent.itemsObs, indexObs: $index }
        }"></div>
    </div>
</div>
